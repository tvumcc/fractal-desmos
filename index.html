<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Fractal Desmos</title>
  </head>
  <body>
    <div class="main-container">
      <div class="side-panel">
        <p>Use the variable <b>x</b> to access the pixel coordinate as a complex number.</p>
        <p>Use the variable <b>t</b> to access the current time as a real number. (imaginary part is 0)</p>
        <p>Use the variable <b>c</b> to access the mouse coordinates as a complex number.</p>

        <div class="entry">
          <p class="equation-indicator">
            z(0)
          </p>
          <p class="equals">=</p>
          <p class="equation-entry">
            <span id="z0">x</span>
          </p>
        </div>
        <div class="entry">
          <p class="equation-indicator">
            f(z)
          </p>
          <p class="equals">=</p>
          <p class="equation-entry">
            <span id="fz">z^2+\cos\left(t\right)+i\sin\left(t\right)</span>
          </p>
        </div>

        <hr>
        <div id="var-sliders"></div>
      </div>
      <div class="fractal-canvas">
        <canvas id="webgpu_canvas"></canvas>
      </div>
    </div>

    <link rel="stylesheet" href="./style.css"/>
    <link rel="stylesheet" href="./lib/mathquill.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script type="module" src="./lib/mathquill.js"></script>
    <script type="module" src="./src/main.ts"></script>
    <script type="module">
    import { parse } from "./src/main.ts"

    let MQ = MathQuill.getInterface(2)
    let symbols = "alpha beta gamma delta epsilon zeta eta theta iota kappa lambda mu nu xi omikron pi rho sigma tau upsilon chi psi omega"

    let z0_entry = MQ.MathField(document.getElementById("z0"), {
      supSubsRequireOperand: true,
      autoCommands: "sqrt " + symbols,
      handlers: {
        edit: function() {
          parse(z0_entry.latex(), equation_entry.latex())
          let math_fields = document.getElementsByClassName("latex");
          for (let math_field of math_fields) {
            MQ.StaticMath(math_field)
            console.log(math_field.innerText)
          }
        }
      }
    })

    let equation_entry = MQ.MathField(document.getElementById("fz"), {
      supSubsRequireOperand: true,
      autoCommands: "sqrt " + symbols,
      handlers: {
        edit: function() {
          parse(z0_entry.latex(), equation_entry.latex())
          let math_fields = document.getElementsByClassName("latex");
          for (let math_field of math_fields) {
            MQ.StaticMath(math_field)
            console.log(math_field.innerText)
          }
        }
      }
    })
    </script>
  </body>
</html>